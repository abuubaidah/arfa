webpackJsonp([7],{"6szS":function(e,t,r){"use strict";function n(e){return function(t){c.a.create("TypeaheadClearRecentResource",{query:e}).callDelete().then(function(){return t(s())})}}function a(e){return{type:"UPDATE_SKIN_TONE_FILTER_QUERY_USES",payload:{newQuery:e}}}t.a=n,t.b=a;var l=r("ZtCB"),c=r.n(l),o=r("S+Qs"),s=function e(){return Object(o.a)("AdvancedTypeaheadResource",{term:"",pin_scope:"pins"})}},CiuA:function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),r.d(t,"SearchTypeahead",function(){return q});var c=r("d6ZO"),o=r.n(c),s=r("DUIN"),u=r("tQ0j"),i=r.n(u),p=r("OIxG"),d=r("GGB8"),m=r.n(d),y=r("W/Cr"),f=r("IaRT"),E=r.n(f),h=r("nX0T"),b=r("skut"),g=r("+kCg"),v=r("JyNp"),_=r("i0Ug"),R=r("suNN"),S=r("6szS"),T=r("+B8E"),I=r("vRYQ"),O=r("gEaE"),N=r("MQ2h"),x=r.n(N),C={BOARD:"board",QUERY:"query",RECENT:"recent_query",RECOMMENDED:"recommended_query",TRENDING:"trending",USER:"user",NEW_RECIPE:"new_recipe",NEW_DECOR:"new_decor",NEW_STYLE:"new_style"},w=38,D=function e(t){var r=t.children;return o.a.createElement(O.b,{flex:"none",height:38,marginRight:2,width:38},r)},k=function e(t){var r=t.children;return o.a.createElement(O.b,{dangerouslySetInlineStyle:{__style:{textOverflow:"ellipsis"}},overflow:"hidden"},r)},Q=o.a.createElement("div",null),q=function(e){function t(){var r,l,c;n(this,t);for(var s=arguments.length,u=Array(s),i=0;i<s;i++)u[i]=arguments[i];return r=l=a(this,e.call.apply(e,[this].concat(u))),l.handleOnClickItem=function(e){var t=l.props;(0,t.onTypeaheadItemSelected)(e,t.value)},l.renderLabelAndSubLabel=function(e){var t=e.label,r=e.subLabel,n=e.verified,a=void 0!==n&&n;return o.a.createElement(O.b,{overflow:"hidden"},o.a.createElement(O.b,{alignItems:"center",display:"flex"},o.a.createElement(O.b,{flex:"grow"},o.a.createElement(O.H,{bold:!0,truncate:!0},t)),a&&o.a.createElement(O.b,{display:"inlineBlock",flex:"none",marginLeft:1},o.a.createElement(O.m,{accessibilityLabel:y.a._("Verified user icon","Accessibility label for verified icon"),color:"red",icon:"check-circle",size:14}))),r&&o.a.createElement(O.b,{marginTop:1},o.a.createElement(O.H,{size:"xs",truncate:!0},r)))},l.renderSearchAllInScopeText=function(e){return o.a.createElement(O.H,{bold:!0,truncate:!0},e)},c=r,a(l,c)}return l(t,e),t.prototype.componentWillReceiveProps=function e(t){var r=this.props,n=r.emptySuggestions,a=r.updateEmptySuggestions;t.emptySuggestions&&n!==t.emptySuggestions&&a(t.emptySuggestions),g.b.mark("visible_progress_elapsed_ms",null)},t.prototype.getTypeaheadGroupTitle=function e(t){switch(t){case C.USER:return y.a._("People");case C.BOARD:return y.a._("Boards");case C.RECENT:return y.a._("Recent searches");case C.RECOMMENDED:return y.a._("Ideas for you");case C.TRENDING:return y.a._("Trending ideas");case C.NEW_RECIPE:return y.a._("Make a new recipe");case C.NEW_DECOR:return y.a._("Spruce up your space");case C.NEW_STYLE:return y.a._("Discover your style");default:return null}},t.prototype.getGroupedResults=function e(t){return i.a.groupBy(t,function(e){return e.type})},t.prototype.renderTypeaheadGroupHeader=function e(t){var r=this.getTypeaheadGroupTitle(t);return r&&o.a.createElement("a",{className:"titleItem",style:{cursor:"default",backgroundColor:"inherit"}},o.a.createElement(O.H,{truncate:!0,size:"xs"},r))},t.prototype.renderTypeaheadGroupItem=function e(t,r){var n=this,a=this.props.typeaheadSuggestionsQuery,l=new T.c(this.props.requestContext,"pride_easter_egg_2018").enabled(),c={backgroundColor:r?"#f1f1f1":"inherit",color:t.color?t.color:""};switch(t.type){case C.QUERY:var s=a.toLowerCase(),u="",i="";return t.label.startsWith(s)?(u=s,i=t.label.slice(s.length)):i=t.label,o.a.createElement("a",{"data-test-id":"search-suggestion",style:c},l&&Object(I.b)(u)?o.a.createElement(k,null,o.a.createElement(I.a,{value:u,boldSuffix:!0}),o.a.createElement(O.H,{inline:!0,truncate:!0},i)):l&&Object(I.b)(u+i)?o.a.createElement(k,null,o.a.createElement(I.a,{value:u+i})):o.a.createElement(k,null,o.a.createElement(O.H,{bold:!0,inline:!0},u),o.a.createElement(O.H,{inline:!0},i)));case C.USER:return t.searchAllInScope?o.a.createElement("a",{className:"user",style:c},this.renderSearchAllInScopeText(Object(R.b)(y.a._('Pinners named "{{ searchText }}"',"See all Pinner results for a search query"),{searchText:a}))):o.a.createElement("a",{className:"user",style:c},o.a.createElement(O.b,{alignItems:"center",display:"flex"},o.a.createElement(D,null,o.a.createElement(O.a,{name:t.label,src:t.image_small_url})),this.renderLabelAndSubLabel(t)));case C.BOARD:return t.searchAllInScope?o.a.createElement("a",{className:"board",style:c},this.renderSearchAllInScopeText(Object(R.b)(y.a._('Boards called "{{ searchText }}"',"See all Board results for a search query"),{searchText:a}))):o.a.createElement("a",{className:"board",style:c},o.a.createElement(O.b,{alignItems:"center",display:"flex"},o.a.createElement(D,null,o.a.createElement(O.s,{shape:"rounded"},o.a.createElement(O.o,{alt:t.label,naturalHeight:38,naturalWidth:38,src:t.image_thumbnail_url}))),this.renderLabelAndSubLabel(t)));case C.RECENT:return o.a.createElement("a",{className:"recentQuery",style:c},o.a.createElement(O.b,{alignItems:"center",display:"flex"},o.a.createElement(O.b,{flex:"grow"},o.a.createElement(k,null,o.a.createElement(I.a,{value:t.label,boldSuffix:!0}))),o.a.createElement(O.b,{display:r?"block":"none",flex:"none",marginBottom:-1,marginTop:-1},o.a.createElement(O.n,{accessibilityLabel:y.a._("Remove","Remove recent search in search typeahead suggestion"),icon:"cancel",onClick:function e(r){var a=r.event;a.stopPropagation(),a.preventDefault(),n.props.removeRecentQuery(t.query)},size:"xs"}))));case C.RECOMMENDED:case C.TRENDING:case C.NEW_RECIPE:case C.NEW_DECOR:case C.NEW_STYLE:return o.a.createElement("a",{className:t.class_name,style:c},o.a.createElement(k,null,o.a.createElement(I.a,{value:t.label,boldSuffix:!0})));default:return null}},t.prototype.renderTypeaheadGroup=function e(t,r,n){var a=this,l=this.props,c=l.hoveredItemIndex,s=l.onHoverItem,u=this.renderTypeaheadGroupHeader(t);return[].concat(u&&[o.a.createElement("li",{key:"group-"+t+"-header",onMouseDown:function e(t){t.preventDefault()}},u)]||[],r.map(function(e,r){var l=n+r;return o.a.createElement("li",{"aria-selected":l===c,key:"group-"+t+"-"+(e.url||r),onBlur:function e(){},onClick:function t(r){r.stopPropagation(),a.handleOnClickItem(e)},onFocus:function e(){return s(l)},onMouseDown:function e(t){t.preventDefault()},onMouseOut:function e(t){t.preventDefault()},onMouseOver:function e(){return s(l)},role:"option"},a.renderTypeaheadGroupItem(e,l===c))}))},t.prototype.render=function e(){var t=this,r=this.props,n=r.className,a=r.emptySuggestions,l=r.emptySuggestionsOverride,c=r.focused,s=r.maxHeight,u=r.onTypeaheadMouseOut,i=r.onTypeaheadSuggestionsChange,p=r.pinScope,d=r.typeaheadSuggestions,y=r.value,f=null;if(c){var E=Q,g=!y&&(l||a)||d,v=this.getGroupedResults(g),_=s?{maxHeight:s,overflowY:"auto"}:null,R=Object.keys(v).reduce(function(e,r){var n=e.listItems,a=e.globalIndexOffset;return{listItems:[].concat(n,t.renderTypeaheadGroup(r,v[r],a)),globalIndexOffset:a+v[r].length}},{listItems:[],globalIndexOffset:0}).listItems;R&&R.length&&(E=o.a.createElement("div",{className:m()(n,"open","Typeahead","typeaheadWithTitles")},o.a.createElement("ul",{className:"results","data-test-id":"typeaheadResults",onBlur:u,onMouseOut:u,style:_,role:"listbox"},R))),f=o.a.createElement(h.a,{view:2,viewParameter:103},E)}return o.a.createElement(b.a,{onTypeaheadSuggestionsChange:i,resourceName:"AdvancedTypeaheadResource",resourceOptions:{pin_scope:p},allowSearchOnMount:!0,value:y},f)},t}(c.Component);t.default=Object(N.compose)(_.a,p.b,Object(v.c)({name:"AdvancedTypeaheadResource",key:"emptySuggestionsResource",options:function e(t){return{term:"",pin_scope:t.pinScope}}},{allowStale:!1}),Object(v.c)({name:"RecommendedQueriesResource",key:"recommendedQueriesResource"}),Object(v.c)({name:"TrendingQueriesResource",key:"trendingQueriesResource"}),Object(s.connect)(function(e){return{emptySuggestions:[].concat((e.search.recentQueries||[]).map(function(e,t){var r=e.query;return{class_name:"recentQuery",label:r,query:r,resultIndex:t,type:"recent_query",url:e.url||"/search/pins/?q="+encodeURIComponent(r)+"&rs=rs"}}),e.search.recommendedQueries.map(function(e,t){var r=e.query;return{label:r,query:r,resultIndex:t,type:"recommended_query",url:e.url||"/search/pins/?q="+encodeURIComponent(r)+"&rs=rec"}}),e.search.trendingQueries.map(function(e,t){var r=e.query;return{label:r,query:r,resultIndex:t,type:"trending",url:e.url||"/search/pins/?q="+encodeURIComponent(r)+"&rs=trending"}}))}},function(e){return{removeRecentQuery:function t(r){return e(Object(S.a)(r))}}}))(q)}});